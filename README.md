# Content Security Policy middleware

Content Security Policy (CSP) helps prevent unwanted content from being injected/loaded into your webpages. This can mitigate cross-site scripting (XSS) vulnerabilities, Clickjacking, formajacking, malicious frames, unwanted trackers, client-side injected malware, and other [web client-side attacks](https://cspscanner.com/client-side-attacks).

This middleware sets Content Security Policies generated by [RapidSec.com](https://rapidsec.com/).

Basic example of setting a report-only policy that sends violation data to the RapidSec report-uri:

```javascript
const contentSecurityPolicy = require("express-csp-generator");

app.use(
  contentSecurityPolicy({
  "directives": {
    "frame-ancestors": ["'none'"],
    "block-all-mixed-content": [],
    "default-src": ["'none'"],
    "script-src": ["'self'","'report-sample'"],
    "style-src": ["'self'","'report-sample'"],
    "object-src": ["'none'"],
    "frame-src": ["'none'"],
    "child-src": ["'none'"],
    "img-src": ["'self'"],
    "font-src": ["'self'"],
    "connect-src": ["'none'"],
    "manifest-src": ["'none'"],
    "base-uri": ["'self'"],
    "form-action": ["'none'"],
    "media-src": ["'none'"],
    "prefetch-src": ["'none'"],
    "worker-src": ["'none'"],
    "report-uri": ["https://gate.rapidsec.net/YOUR_SPECIFIC_RAPIDSEC_PROJECT_ID"]
  },
  "reportOnly": true
})
);
```

This middleware does minimal validation - You should use a more sophisticated CSP validator, like [CSP Scanner](https://cspscanner.com/) to make sure your CSP is both valid, and effective at mitigating attacks, or prefrabely, [generate your CSP on RapidSec](https://rapidsec.com/csp-automation).



## See also

- [CSP Scanner](https://cspscanner.com/)
- [CSP Bypasses](https://cspscanner.com/csp-bypasses)

## Legal
Original code modified from MIT licensed [Helmet-CSP](https://github.com/helmetjs/helmet/tree/main/middlewares/content-security-policy)
